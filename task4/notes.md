## Setting up JFrog

One way to install JFrog is to follow instructions on [this page](https://jfrog.com/artifactory/install/).
If installed successfully on Ubuntu, Artifactory will be started as a service listening on ports 8081 and 8082.
Once loaded, enter the defaults administrator credentials - username: admin, password: password. Once logged in, change the admin password and enter your licence key.

## On JFrog repositories

Among local, remote and virtual repositories, local is the only type that physically stores artifacts.
A remote repository acts as a caching proxy to another repository which can be of any type.
Virtual repositories are aggregates of other suitable repositories. For example, a virtual Docker repository can encompass a local Docker registry and a proxy to Docker Hub.

## Accessing JFrog Docker registries

JFrog Docker registries require a reverse proxy. However, newer versions of JFrog come with a preconfigured Tomcat reverse proxy that works out-of-the-box.

To access a JFrog registry on new versions of JFrog, unlike with other types of repositories, use urls without the <code>/artifactory/</code> path segment.

```
docker login 10.0.0.15:8082/my-docker-repository
docker pull 10.0.0.15:8082/my-docker-repository/hello-world:latest
```

## JFrog behind Nginx proxy

After installing nginx, to setup proxying, save a file with the code below in the /etc/nginx/sites-enabled directory (replace <SERVER_NAME> with the server's IP address or name if name resolution is possible).
Change JFrog HTTP Settings to use nginx as proxy. Note: there is a builtin proxying code generator but it doesn't always generate valid output.
Restart nginx and artifactory services.

These settings will forward all HTTP traffic (arrived on port 80) to ports used by JFrog.

```
###########################################################

## this configuration was generated by JFrog Artifactory ##

###########################################################

## server configuration

server {

    listen 80 ;

    server_name <SERVER_NAME>;

    if ($http_x_forwarded_proto = '') {

        set $http_x_forwarded_proto  $scheme;

    }

    ## Application specific logs

    ## access_log /var/log/nginx/<SERVER_NAME>-access.log timing;

    ## error_log /var/log/nginx/<SERVER_NAME>-error.log;

    rewrite ^/$ /ui/ redirect;

    rewrite ^/ui$ /ui/ redirect;

    proxy_buffer_size          128k;

    proxy_buffers              4 256k;

    proxy_busy_buffers_size    256k;

    chunked_transfer_encoding on;

    client_max_body_size 0;

    location / {

    proxy_read_timeout  2400s;

    proxy_pass_header   Server;

    proxy_cookie_path   ~*^/.* /;

    proxy_pass          localhost:8082;

    proxy_set_header    X-JFrog-Override-Base-Url $http_x_forwarded_proto://$host:$server_port;

    proxy_set_header    X-Forwarded-Port  $server_port;

    proxy_set_header    X-Forwarded-Proto $http_x_forwarded_proto;

    proxy_set_header    Host              $http_host;

    proxy_set_header    X-Forwarded-For   $proxy_add_x_forwarded_for;

        location ~ ^/artifactory/ {

            proxy_pass    localhost:8081;

        }

    }

}
```
